<!--~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
  Copyright © 2019-2022 Metreeca srl

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
  ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~-->

<!DOCTYPE html>
<html lang="en">
    <head><title>A minimalist Maven plugin for static site generation | Metreeca/Mark</title>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <link rel="shortcut icon" href="./index.svg">
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/themes/prism.min.css">
        <link rel="stylesheet" type="text/css" href="./index.css">
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/components/prism-core.min.js"></script>
        <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.26.0/plugins/autoloader/prism-autoloader.min.js"></script>
        <script type="text/javascript" src="./index.js"></script>
    </head>
    <body><input id="toggle" type="checkbox">
        <nav>
            <header>
                <a href="https://www.metreeca.com/" title="Metreeca" style="background-image: url(./index.svg)"></a><span><a href=".">Metreeca/Mark</a></span><label for="toggle"></label>
            </header>
            <section><a href="https://github.com/metreeca/mark">v0.8.7</a><h1><a href="#metreecamark">Metreeca/Mark</a>
            </h1><h1><a href="#usage">Usage</a></h1><h2><a href="#configure-the-plugin">Configure the plugin</a></h2><h2>
                <a href="#define-a-template">Define a template</a></h2><h2><a href="#create-site-content">Create site
                content</a></h2><h1><a href="#maven-goals">Maven Goals</a></h1><h2><a href="#clean">Clean</a></h2><h2>
                <a href="#build">Build</a></h2><h2><a href="#watch">Watch</a></h2><h2><a href="#serve">Serve</a></h2><h1>
                <a href="#file-pipelines">File Pipelines</a></h1><h2><a href="#markdown">Markdown</a></h2><h2>
                <a href="#lesscss">Less/CSS</a></h2><h1><a href="#support">Support</a></h1><h1>
                <a href="#license">License</a></h1></section>
        </nav>
        <main>
            <header>
                <a href="https://www.metreeca.com/" title="Metreeca" style="background-image: url(./index.svg)"></a><span><button title="Scroll to Top" onclick="document.querySelector('main').scrollTo(0, 0)">A minimalist Maven plugin for static site generation</button></span><label for="toggle"></label>
            </header>
            <section><p>
                <a href="https://search.maven.org/artifact/com.metreeca/mark-maven-plugin/" target="_blank"><img src="https://img.shields.io/maven-central/v/com.metreeca/mark-maven-plugin.svg" alt="Maven Central" target="_blank"/></a>
            </p>
                <h1 id="metreecamark">Metreeca/Mark</h1>
                <p>Metreeca/Mark is a minimalist Maven plugin for static site generation. It is tightly integrated in the
                    build process and
                    doesn't require specific site layouts or complex setups: just throw in a couple of Markdown pages and
                    maybe a Pug/Less
                    template and let the generator take care of the details…</p>
                <h1 id="usage">Usage</h1>
                <h2 id="configure-the-plugin">Configure the plugin</h2>
                <p>Add the plugin to your build configuration as:</p>
                <pre><code class="language-xml">&lt;build&gt;

    &lt;plugins&gt;

        &lt;plugin&gt;

            &lt;groupId&gt;com.metreeca&lt;/groupId&gt;
            &lt;artifactId&gt;mark-maven-plugin&lt;/artifactId&gt;
            &lt;version&gt;0.8.7&lt;/version&gt;

            &lt;configuration&gt; &lt;!-- optional --&gt;

                &lt;source&gt;src/docs&lt;/source&gt;
                &lt;target&gt;target/docs&lt;/target&gt;
                &lt;layout&gt;layouts/default.pug&lt;/layout&gt;

                &lt;readme&gt;true&lt;/readme&gt;

                &lt;options&gt; &lt;!-- pipeline specific options --&gt;
                    &lt;pipeline-option&gt;value&lt;/pipeline-option&gt;
                &lt;/options&gt;

            &lt;/configuration&gt;

            &lt;executions&gt;
                &lt;execution&gt;

                    &lt;goals&gt;
                        &lt;goal&gt;clean&lt;/goal&gt; &lt;!-- by default in the pre-clean phase--&gt;
                        &lt;goal&gt;build&lt;/goal&gt; &lt;!-- by default in the pre-site phase--&gt;
                    &lt;/goals&gt;

                &lt;/execution&gt;
            &lt;/executions&gt;

        &lt;/plugin&gt;

    &lt;/plugins&gt;

&lt;/build&gt;
</code></pre>
<p>The following optional configuration parameters are available:</p>
<table>
<thead>
<tr><th>parameter</th><th>default</th><th>value</th></tr>
</thead>
<tbody>
<tr><td><code>source</code></td><td><code>./docs</code></td><td>the source folder for the site</td></tr>
<tr><td><code>target</code></td><td><code>${source}</code></td><td>the target folder for the generated site<br/>defaults to in-place generation</td></tr>
<tr><td><code>layout</code></td><td> </td><td>the path of default page template relative to <code>${source}</code><br/>defaults to a bundled docs layout</td></tr>
<tr><td><code>readme</code></td><td><code>false</code></td><td>generates a <code>README.md</code> file in the base project folder from <code>${source}/index.md</code><br/>relative links are rewritten to <code>${project.distributionManagement.site.url}</code>, if defined in <code>pom.xml</code>, or to the original location under the <code>target</code> folder, otherwise</td></tr>
</tbody>
</table>
<h2 id="define-a-template">Define a template</h2>
<blockquote>
<p><img src="https://github.githubassets.com/images/icons/emoji/unicode/2139.png?v7" alt="emoji symbols:information_source" height="20" width="20" align="absmiddle" /></p>
<p>If you feel lazy, just omit the <code>layout</code> parameter and place an <code>index.svg</code> icon in the source
folder to use the default <a href="samples/">bundled docs layout</a> ;-)</p>
</blockquote>
<p>Define a default Pug template under the <code>source</code> folder at the relative path specified by the <code>layout</code> parameter, for
instance:</p>
<pre><code class="language-pug">doctype html

html(lang=&quot;en&quot;)

    head

        title #{page.title} &quot; | &quot; #{project.name}

        meta(charset=&quot;UTF-8&quot;)

    body

        header
            h1 Example Site

        main !{page.body}

        footer
            small © 2020 Example
</code></pre>
<p>The following properties are available for inclusion using the <code>#/!{expression}</code> syntax:</p>
<table>
<thead>
<tr><th>property</th><th>value</th></tr>
</thead>
<tbody>
<tr><td><code>page.*</code></td><td>page front matter properties</td></tr>
<tr><td><code>page.date</code></td><td>the page date in ISO format (<code>yyyy-mm-dd</code>); defaults to the current date, unless specified in the front matter</td></tr>
<tr><td><code>page.root</code></td><td>the path of the site root relative to the page</td></tr>
<tr><td><code>page.base</code></td><td>the path of the page folder relative to the site root</td></tr>
<tr><td><code>page.path</code></td><td>the path of the page relative to the site root</td></tr>
<tr><td><code>page.headings</code></td><td>a list of page (use <code>heading.level</code>, <code>heading.id</code> and <code>heading.text</code> to generate TOCs</td></tr>
<tr><td><code>page.body</code></td><td>page content rendered as HTML</td></tr>
<tr><td><code>pages[]</code></td><td>a list containing  <code>page</code> objects for all HTML pages</td></tr>
<tr><td><code>project.*</code></td><td>Maven project properties</td></tr>
</tbody>
</table>
<blockquote>
<p><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v7" alt="emoji places:warning" height="20" width="20" align="absmiddle" /></p>
<p>Pug templates are rendered using <a href="https://github.com/neuland/pug4j" target="_blank">pug4j</a>: expressions are evaluated as
<a href="http://commons.apache.org/proper/commons-jexl/" target="_blank">JEXL</a>
rather than Javascript. Expression interpolation in HTML attributes is supported as <code>${expression}</code></p>
</blockquote>
<h2 id="create-site-content">Create site content</h2>
<p>Define site pages as <code>.md</code> files under the <code>source</code> folder, for instance as:</p>
<pre><code class="language-markdown">---
title: Lorem Ipsum
---

Lorem ipsum `${project.version}` dolor sit amet, consectetur adipiscing elit…
</code></pre>
<p>All the properties available to templates (with the obvious exception of <code>page.body</code>) are also available for
interpolation inside pages using the <code></code> syntax (escape like <code>${expression}</code> to include verbatim).</p>
<p>The template to be used for rendering the page may be explicitly selected by setting the <code>layout</code> front matter property
to the path of the required template, relative to the plugin <code>layout</code> parameter.</p>
<blockquote>
<p><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v7" alt="emoji places:warning" height="20" width="20" align="absmiddle" /></p>
<p>Markdown pages are parsed using <a href="https://github.com/vsch/flexmark-java" target="_blank">flexmark</a>: YAML front matter is
supported with a <a href="https://github.com/vsch/flexmark-java/wiki/Extensions#yaml-front-matter" target="_blank">limited syntax</a>.</p>
</blockquote>
<h1 id="maven-goals">Maven Goals</h1>
<h2 id="clean">Clean</h2>
<pre><code class="language-shell">mvn mark:clean # by default in the pre-clean phase
</code></pre>
<ul>
<li>the <code>target</code> folder is deleted</li>
</ul>
<h2 id="build">Build</h2>
<pre><code class="language-shell">mvn mark:build # by default in the pre-site phase
</code></pre>
<ul>
<li>supported files in the <code>source</code> folder are processed by the matching <a href="#file-pipelines">file pipeline</a></li>
<li>templates (that is, files with the same extensions as the default template specified by the <code>layout</code> parameter) are
ignored</li>
<li>everything else under the <code>source</code> folder is copied verbatim to the same relative path under the <code>target</code> folder</li>
<li>HTML files under the <code>target</code> folder are scanned and dangling links reported</li>
</ul>
<blockquote>
<p><img src="https://github.githubassets.com/images/icons/emoji/unicode/26a0.png?v7" alt="emoji places:warning" height="20" width="20" align="absmiddle" /></p>
<p>When generating sites in-place, files converted without altering the file extension (for instance,
<code>.css</code> › <code>.css</code>) are silently ignored.</p>
</blockquote>
<h2 id="watch">Watch</h2>
<pre><code class="language-shell">mvn mark:watch
</code></pre>
<ul>
<li>the site is generated as described above</li>
<li>on file updates and additions under the <code>source</code> folder, the corresponding files under the <code>target</code> folder are
regenerated as required; if a template is modified, the whole site is regenerated</li>
</ul>
<h2 id="serve">Serve</h2>
<pre><code class="language-shell">mvn mark:serve
</code></pre>
<ul>
<li>the site is generated and watched as described above</li>
<li>the generated site is served on an embedded HTTP server for testing purposes</li>
<li>on supported systems, the served site is automatically opened in the default user browser</li>
<li>pages are automatically reloaded on updates</li>
</ul>
<h1 id="file-pipelines">File Pipelines</h1>
<h2 id="markdown">Markdown</h2>
<p>Converts <code>.md</code> files under the <code>source</code> folder to <code>.html</code> files at the same relative path under the <code>target</code> folder,
using the default Pug template specified by the <code>layout</code> parameter or by the <code>layout</code> front-matter property; links to
other <code>.md</code> files are converted to the corresponding <code>.html</code> file.</p>
<table>
<thead>
<tr><th>option</th><th>default</th><th>behaviour</th></tr>
</thead>
<tbody>
<tr><td><code>markdown-smart-links</code></td><td><code>false</code></td><td>removes <code>.html</code> and <code>index.html</code> suffixes from links</td></tr>
<tr><td><code>markdown-external-links</code></td><td><code>false</code></td><td>opens external links in a <code>_blank</code> target</td></tr>
</tbody>
</table>
<h2 id="lesscss">Less/CSS</h2>
<p>Converts <code>.less</code> and <code>.css</code> files under the <code>source</code> folder to minified <code>.css</code> files at the same relative path under
the <code>target</code> folder.</p>
<h1 id="support">Support</h1>
<ul>
<li>open an <a href="https://github.com/metreeca/mark/issues" target="_blank">issue</a> to report a problem or to suggest a new feature</li>
<li>start a <a href="https://github.com/metreeca/mark/discussions" target="_blank">discussion</a> to ask a how-to question or to share an idea</li>
</ul>
<h1 id="license">License</h1>
<p>This project is licensed under the Apache 2.0 License – see <a href="https://github.com/metreeca/mark/blob/main/LICENSE" target="_blank">LICENSE</a>
file for details.</p>
</section><footer>© 2022 Metreeca srl. This work is licensed under the <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">Creative Commons BY-NC-SA 4.0 License</a></footer></main></body></html>